b) Implement MapReduce operation with suitable example using MongoDB.

// ----------------------------------------------------------
// ðŸŸ¢ STEP 1 â€” Use your database
// ----------------------------------------------------------
use OnlineShoppingDB;


// ----------------------------------------------------------
// ðŸŸ¢ STEP 2 â€” Create sample 'orders' collection (if not exists)
// ----------------------------------------------------------
db.orders.insertMany([
  { _id: 1, product: "Laptop", quantity: 1, total_amount: 55000 },
  { _id: 2, product: "Smartphone", quantity: 2, total_amount: 50000 },
  { _id: 3, product: "Laptop", quantity: 1, total_amount: 55000 },
  { _id: 4, product: "Headphones", quantity: 3, total_amount: 6000 },
  { _id: 5, product: "Smartwatch", quantity: 2, total_amount: 10000 },
  { _id: 6, product: "Smartphone", quantity: 1, total_amount: 25000 }
]);


// ----------------------------------------------------------
// ðŸŸ¡ STEP 3 â€” Define MAP function
// ----------------------------------------------------------
// The MAP function emits (key, value) pairs
// Here, key = product name, value = total_amount of that product

var mapFunction = function() {
    emit(this.product, this.total_amount);
};


// ----------------------------------------------------------
// ðŸ”µ STEP 4 â€” Define REDUCE function
// ----------------------------------------------------------
// The REDUCE function groups all amounts for same product
// and returns their total sum

var reduceFunction = function(key, values) {
    return Array.sum(values);
};


// ----------------------------------------------------------
// ðŸŸ£ STEP 5 â€” Execute MapReduce
// ----------------------------------------------------------
// The result will be stored in a new collection named 'product_sales_total'

db.orders.mapReduce(
    mapFunction,
    reduceFunction,
    {
        out: "product_sales_total"
    }
);


// ----------------------------------------------------------
// ðŸ”´ STEP 6 â€” View the MapReduce output
// ----------------------------------------------------------
db.product_sales_total.find().pretty();
